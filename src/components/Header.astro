---
import { motion } from "framer-motion";
---

<header
  role="banner"
  class="fixed left-1/2 top-2 z-50 min-h-14 w-[95vw] max-w-[90vw] -translate-x-1/2 rounded-2xl border border-white/20 bg-gradient-to-br from-gray-900/80 via-gray-800/70 to-gray-900/60 px-3 text-white shadow-[0_8px_32px_0_rgba(0,0,0,0.3)] backdrop-blur-xl transition-all duration-300 hover:border-white/30 hover:shadow-[0_8px_32px_0_rgba(0,0,0,0.4)] sm:top-4 sm:w-[90vw] sm:rounded-3xl sm:px-4 md:px-6"
>
  <nav
    role="navigation"
    aria-label="Navegación principal"
    class="relative flex w-full items-center justify-between px-2 py-2 sm:px-4"
  >
    <div class="flex flex-col items-center md:items-start">
      <img
        src="/images/logo_uc_orange_hd.svg"
        alt="Logo Unidad C"
        width="140"
        height="auto"
        class="h-auto w-28 sm:w-36 md:w-40 lg:w-44"
      />
    </div>

    <div class="mx-4 hidden space-x-4 lg:flex xl:space-x-8">
      <a
        href="/"
        class="rounded-2xl border border-transparent px-4 py-2 text-center text-lg font-medium text-white/90 transition-all duration-300 hover:border-white/40 hover:bg-white/15 hover:text-white hover:shadow-lg hover:backdrop-blur-xl"
      >
        Inicio
      </a>

      <!-- Herramientas Dropdown -->
      <div class="relative group">
        <button
          type="button"
          class="flex items-center rounded-2xl border border-transparent px-4 py-2 text-center text-lg font-medium text-white/90 transition-all duration-300 hover:border-white/40 hover:bg-white/15 hover:text-white hover:shadow-lg hover:backdrop-blur-xl"
          aria-haspopup="true"
        >
          Herramientas
          <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"
            ></path>
          </svg>
        </button>

        <div
          class="absolute left-0 z-50 mt-2 w-44 overflow-hidden rounded-xl border border-white/20 bg-gradient-to-br from-gray-900/90 via-gray-800/85 to-gray-900/80 text-white shadow-[0_8px_32px_0_rgba(0,0,0,0.4)] backdrop-blur-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300"
        >

          <a
            href="/knowip"
            class="block border-b border-white/10 px-4 py-2 text-white/90 transition-all duration-300 last:border-b-0 hover:bg-white/15 hover:text-white hover:backdrop-blur-lg"
          >
            IP pública
          </a>
          <a
            href="/genpass"
            class="block border-b border-white/10 px-4 py-2 text-white/90 transition-all duration-300 last:border-b-0 hover:bg-white/15 hover:text-white hover:backdrop-blur-lg"
          >
            Generador de Password
          </a>
        </div>
      </div>
    </div>

    <div class="flex items-center space-x-4">
      <div class="hidden md:block">
        <p class="-mb-0.5 text-[9px] text-gray-400 md:text-[10px]">DOF</p>
        <p class="text-xs font-medium text-white/90 md:text-sm">
          USD/MXN: <span id="header-rate-value">Cargando...</span>
        </p>
        <p class="text-[9px] text-gray-400 md:text-[10px]">
          Fecha: <span id="header-date-value">--</span>
        </p>
      </div>
    </div>

    <!-- Mobile menu button -->
    <button
      type="button"
      class="relative z-50 p-2 focus:outline-none lg:hidden"
      id="mobile-menu-button"
      aria-label="Menú Principal"
    >
      <svg class="w-6 h-6 sm:w-7 sm:h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M4 6h16M4 12h16M4 18h16"></path>
      </svg>
    </button>

    <!-- Mobile menu -->
    <div
      id="mobile-menu"
      class="absolute left-0 top-full w-full space-y-2 rounded-b-2xl border border-white/20 bg-gradient-to-br from-gray-900/85 via-gray-800/75 to-gray-900/70 p-3 text-white shadow-[0_8px_32px_0_rgba(0,0,0,0.4)] backdrop-blur-xl sm:space-y-3 sm:rounded-b-3xl sm:p-4 lg:hidden opacity-0 invisible transition-all duration-300"
    >
      <a
        href="/"
        class="block rounded-2xl px-4 py-2 text-center font-medium text-white/90 transition duration-300 hover:bg-white/15 hover:text-white"
      >
        Inicio
      </a>

      <div class="mb-2">
        <button
          type="button"
          class="flex w-full items-center rounded-2xl px-4 py-2 text-center font-medium text-white/90 transition duration-300 hover:bg-white/15 hover:text-white"
          id="mobile-tools-button"
        >
          Herramientas
          <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"
            ></path>
          </svg>
        </button>
        <div class="pl-4 hidden" id="mobile-tools-menu">
          <a href="/knowip" class="block rounded-2xl px-4 py-2 transition hover:bg-white/15"
            >IP pública</a>
          <a href="/genpass" class="block rounded-2xl px-4 py-2 transition hover:bg-white/15"
            >Generador de Password</a>
        </div>
      </div>
    </div>
  </nav>
</header>

<script is:inline>
  document.addEventListener("astro:page-load", () => {
    const mobileMenuButton = document.getElementById("mobile-menu-button");
    const mobileMenu = document.getElementById("mobile-menu");
    const mobileToolsButton = document.getElementById("mobile-tools-button");
    const mobileToolsMenu = document.getElementById("mobile-tools-menu");

    function openMobileMenu() {
      mobileMenu?.classList.remove("opacity-0", "invisible");
      mobileToolsMenu?.classList.add("hidden");
    }

    function closeMobileMenu() {
      mobileMenu?.classList.add("opacity-0", "invisible");
      mobileToolsMenu?.classList.add("hidden");
    }

    function toggleMobileTools() {
      mobileToolsMenu?.classList.toggle("hidden");
    }

    mobileMenuButton?.addEventListener("click", () => {
      if (mobileMenu?.classList.contains("invisible")) {
        openMobileMenu();
      } else {
        closeMobileMenu();
      }
    });
    mobileToolsButton?.addEventListener("click", toggleMobileTools);

    // Close mobile menu when clicking on links
    mobileMenu?.querySelectorAll("a").forEach((link) => {
      link.addEventListener("click", closeMobileMenu);
    });
  });
</script>
