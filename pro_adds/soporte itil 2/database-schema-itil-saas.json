{
  "database_schema": {
    "description": "Estructura de base de datos para Sistema de Gestión de Servicios TI - ITIL v4 SaaS",
    "version": "1.0.0",
    "date": "2025-02-05",
    
    "tables": {
      "organizations": {
        "description": "Tabla de organizaciones/clientes (multi-tenancy)",
        "fields": {
          "id": "UUID PRIMARY KEY",
          "name": "VARCHAR(255) NOT NULL",
          "domain": "VARCHAR(255) UNIQUE",
          "plan": "ENUM('starter', 'professional', 'enterprise')",
          "status": "ENUM('active', 'suspended', 'cancelled') DEFAULT 'active'",
          "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP",
          "updated_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP",
          "settings": "JSON"
        },
        "indexes": ["domain", "status"]
      },
      
      "users": {
        "description": "Usuarios del sistema",
        "fields": {
          "id": "UUID PRIMARY KEY",
          "organization_id": "UUID FOREIGN KEY REFERENCES organizations(id)",
          "email": "VARCHAR(255) UNIQUE NOT NULL",
          "name": "VARCHAR(255) NOT NULL",
          "role": "ENUM('admin', 'agent', 'technician', 'user') DEFAULT 'user'",
          "department": "VARCHAR(100)",
          "phone": "VARCHAR(20)",
          "status": "ENUM('active', 'inactive', 'suspended') DEFAULT 'active'",
          "last_login": "TIMESTAMP",
          "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP",
          "updated_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP",
          "preferences": "JSON"
        },
        "indexes": ["organization_id", "email", "role", "status"]
      },
      
      "incidents": {
        "description": "Gestión de Incidentes (Incident Management)",
        "fields": {
          "id": "UUID PRIMARY KEY",
          "incident_number": "VARCHAR(50) UNIQUE NOT NULL",
          "organization_id": "UUID FOREIGN KEY REFERENCES organizations(id)",
          "requester_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "assigned_to_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "assigned_group": "VARCHAR(100)",
          "reported_date": "TIMESTAMP NOT NULL",
          "category": "VARCHAR(100) NOT NULL",
          "subcategory": "VARCHAR(100)",
          "impact": "ENUM('1', '2', '3', '4') NOT NULL",
          "urgency": "ENUM('1', '2', '3', '4') NOT NULL",
          "priority": "ENUM('Crítica', 'Alta', 'Media', 'Baja') NOT NULL",
          "status": "ENUM('Nuevo', 'Asignado', 'En Progreso', 'Pendiente', 'Resuelto', 'Cerrado') DEFAULT 'Nuevo'",
          "short_description": "VARCHAR(255) NOT NULL",
          "description": "TEXT NOT NULL",
          "steps_to_reproduce": "TEXT",
          "resolution": "TEXT",
          "resolution_code": "VARCHAR(100)",
          "root_cause": "TEXT",
          "configuration_item_id": "UUID FOREIGN KEY REFERENCES configuration_items(id)",
          "location": "VARCHAR(255)",
          "sla_response_hours": "INT DEFAULT 4",
          "sla_resolution_hours": "INT DEFAULT 24",
          "response_time": "TIMESTAMP",
          "resolution_time": "TIMESTAMP",
          "sla_breached": "BOOLEAN DEFAULT FALSE",
          "related_problem_id": "UUID FOREIGN KEY REFERENCES problems(id)",
          "parent_incident_id": "UUID FOREIGN KEY REFERENCES incidents(id)",
          "closed_at": "TIMESTAMP",
          "closed_by_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP",
          "updated_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP",
          "created_by_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "updated_by_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "custom_fields": "JSON"
        },
        "indexes": [
          "organization_id", 
          "incident_number", 
          "status", 
          "priority", 
          "requester_id",
          "assigned_to_id",
          "created_at",
          "sla_breached"
        ]
      },
      
      "incident_notes": {
        "description": "Notas de trabajo en incidentes",
        "fields": {
          "id": "UUID PRIMARY KEY",
          "incident_id": "UUID FOREIGN KEY REFERENCES incidents(id) ON DELETE CASCADE",
          "user_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "note_type": "ENUM('work_note', 'customer_note', 'resolution') DEFAULT 'work_note'",
          "content": "TEXT NOT NULL",
          "is_internal": "BOOLEAN DEFAULT FALSE",
          "time_spent_minutes": "INT",
          "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP",
          "updated_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"
        },
        "indexes": ["incident_id", "created_at"]
      },
      
      "service_requests": {
        "description": "Solicitudes de Servicio (Service Request Management)",
        "fields": {
          "id": "UUID PRIMARY KEY",
          "request_number": "VARCHAR(50) UNIQUE NOT NULL",
          "organization_id": "UUID FOREIGN KEY REFERENCES organizations(id)",
          "requester_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "requested_for_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "requested_date": "TIMESTAMP NOT NULL",
          "request_type": "VARCHAR(100) NOT NULL",
          "catalog_item_id": "UUID FOREIGN KEY REFERENCES service_catalog(id)",
          "status": "ENUM('Pendiente Aprobación', 'Aprobado', 'En Ejecución', 'Completado', 'Rechazado', 'Cancelado') DEFAULT 'Pendiente Aprobación'",
          "priority": "ENUM('Baja', 'Media', 'Alta') DEFAULT 'Media'",
          "description": "TEXT NOT NULL",
          "business_justification": "TEXT",
          "approval_status": "ENUM('Pending', 'Approved', 'Rejected')",
          "approved_by_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "approved_at": "TIMESTAMP",
          "completed_at": "TIMESTAMP",
          "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP",
          "updated_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP",
          "created_by_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "request_data": "JSON"
        },
        "indexes": ["organization_id", "request_number", "status", "requester_id", "created_at"]
      },
      
      "problems": {
        "description": "Gestión de Problemas (Problem Management)",
        "fields": {
          "id": "UUID PRIMARY KEY",
          "problem_number": "VARCHAR(50) UNIQUE NOT NULL",
          "organization_id": "UUID FOREIGN KEY REFERENCES organizations(id)",
          "identified_date": "TIMESTAMP NOT NULL",
          "category": "VARCHAR(100) NOT NULL",
          "subcategory": "VARCHAR(100)",
          "priority": "ENUM('Crítica', 'Alta', 'Media', 'Baja') NOT NULL",
          "status": "ENUM('Identificado', 'En Análisis', 'Solución Conocida', 'Resuelto', 'Cerrado') DEFAULT 'Identificado'",
          "assigned_to_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "assigned_group": "VARCHAR(100)",
          "short_description": "VARCHAR(255) NOT NULL",
          "description": "TEXT NOT NULL",
          "root_cause_analysis": "TEXT",
          "workaround": "TEXT",
          "permanent_solution": "TEXT",
          "known_error": "BOOLEAN DEFAULT FALSE",
          "knowledge_article_id": "UUID FOREIGN KEY REFERENCES knowledge_base(id)",
          "resolved_at": "TIMESTAMP",
          "closed_at": "TIMESTAMP",
          "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP",
          "updated_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP",
          "created_by_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "custom_fields": "JSON"
        },
        "indexes": ["organization_id", "problem_number", "status", "priority", "created_at"]
      },
      
      "problem_incidents": {
        "description": "Relación entre Problemas e Incidentes",
        "fields": {
          "id": "UUID PRIMARY KEY",
          "problem_id": "UUID FOREIGN KEY REFERENCES problems(id) ON DELETE CASCADE",
          "incident_id": "UUID FOREIGN KEY REFERENCES incidents(id) ON DELETE CASCADE",
          "relationship_type": "ENUM('caused_by', 'related_to') DEFAULT 'caused_by'",
          "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP"
        },
        "indexes": ["problem_id", "incident_id"],
        "unique_constraints": ["problem_id, incident_id"]
      },
      
      "changes": {
        "description": "Gestión de Cambios (Change Management)",
        "fields": {
          "id": "UUID PRIMARY KEY",
          "change_number": "VARCHAR(50) UNIQUE NOT NULL",
          "organization_id": "UUID FOREIGN KEY REFERENCES organizations(id)",
          "change_type": "ENUM('Estándar', 'Normal', 'Emergencia') NOT NULL",
          "request_date": "TIMESTAMP NOT NULL",
          "planned_start_date": "TIMESTAMP",
          "planned_end_date": "TIMESTAMP",
          "actual_start_date": "TIMESTAMP",
          "actual_end_date": "TIMESTAMP",
          "requester_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "implementer_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "change_manager_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "risk": "ENUM('Bajo', 'Medio', 'Alto', 'Crítico') NOT NULL",
          "impact": "ENUM('Bajo', 'Medio', 'Alto', 'Crítico') NOT NULL",
          "status": "ENUM('Borrador', 'Pendiente Aprobación', 'Aprobado', 'Programado', 'En Implementación', 'Completado', 'Fallido', 'Cancelado') DEFAULT 'Borrador'",
          "short_description": "VARCHAR(255) NOT NULL",
          "description": "TEXT NOT NULL",
          "business_justification": "TEXT NOT NULL",
          "implementation_plan": "TEXT",
          "backout_plan": "TEXT",
          "test_plan": "TEXT",
          "affected_services": "TEXT",
          "downtime_required": "BOOLEAN DEFAULT FALSE",
          "downtime_start": "TIMESTAMP",
          "downtime_end": "TIMESTAMP",
          "cab_approval_required": "BOOLEAN DEFAULT TRUE",
          "cab_date": "TIMESTAMP",
          "approved_by_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "approved_at": "TIMESTAMP",
          "rejection_reason": "TEXT",
          "post_implementation_review": "TEXT",
          "success": "BOOLEAN",
          "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP",
          "updated_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP",
          "created_by_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "custom_fields": "JSON"
        },
        "indexes": [
          "organization_id", 
          "change_number", 
          "status", 
          "change_type",
          "planned_start_date",
          "risk"
        ]
      },
      
      "change_cis": {
        "description": "CIs afectados por un cambio",
        "fields": {
          "id": "UUID PRIMARY KEY",
          "change_id": "UUID FOREIGN KEY REFERENCES changes(id) ON DELETE CASCADE",
          "configuration_item_id": "UUID FOREIGN KEY REFERENCES configuration_items(id)",
          "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP"
        },
        "indexes": ["change_id", "configuration_item_id"]
      },
      
      "configuration_items": {
        "description": "CMDB - Base de Datos de Configuración",
        "fields": {
          "id": "UUID PRIMARY KEY",
          "ci_id": "VARCHAR(50) UNIQUE NOT NULL",
          "organization_id": "UUID FOREIGN KEY REFERENCES organizations(id)",
          "ci_name": "VARCHAR(255) NOT NULL",
          "ci_type": "ENUM('Hardware', 'Software', 'Network', 'Server', 'Database', 'Application', 'Service', 'Documentation') NOT NULL",
          "ci_subtype": "VARCHAR(100)",
          "ci_status": "ENUM('En Operación', 'En Mantenimiento', 'Retirado', 'En Stock', 'Reparación') DEFAULT 'En Operación'",
          "manufacturer": "VARCHAR(100)",
          "model": "VARCHAR(100)",
          "serial_number": "VARCHAR(100)",
          "asset_tag": "VARCHAR(100)",
          "location": "VARCHAR(255)",
          "owner_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "support_group": "VARCHAR(100)",
          "purchase_date": "DATE",
          "warranty_end_date": "DATE",
          "end_of_life_date": "DATE",
          "cost": "DECIMAL(10,2)",
          "criticality": "ENUM('Baja', 'Media', 'Alta', 'Crítica') DEFAULT 'Media'",
          "description": "TEXT",
          "ip_address": "VARCHAR(45)",
          "mac_address": "VARCHAR(17)",
          "os": "VARCHAR(100)",
          "os_version": "VARCHAR(50)",
          "installed_date": "DATE",
          "last_audit_date": "DATE",
          "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP",
          "updated_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP",
          "created_by_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "attributes": "JSON"
        },
        "indexes": [
          "organization_id", 
          "ci_id", 
          "ci_type", 
          "ci_status",
          "serial_number",
          "asset_tag",
          "criticality"
        ]
      },
      
      "ci_relationships": {
        "description": "Relaciones entre Configuration Items",
        "fields": {
          "id": "UUID PRIMARY KEY",
          "parent_ci_id": "UUID FOREIGN KEY REFERENCES configuration_items(id) ON DELETE CASCADE",
          "child_ci_id": "UUID FOREIGN KEY REFERENCES configuration_items(id) ON DELETE CASCADE",
          "relationship_type": "ENUM('Runs On', 'Depends On', 'Connected To', 'Part Of', 'Uses', 'Hosted On') NOT NULL",
          "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP",
          "created_by_id": "UUID FOREIGN KEY REFERENCES users(id)"
        },
        "indexes": ["parent_ci_id", "child_ci_id"],
        "unique_constraints": ["parent_ci_id, child_ci_id, relationship_type"]
      },
      
      "knowledge_base": {
        "description": "Base de Conocimiento (Knowledge Management)",
        "fields": {
          "id": "UUID PRIMARY KEY",
          "kb_id": "VARCHAR(50) UNIQUE NOT NULL",
          "organization_id": "UUID FOREIGN KEY REFERENCES organizations(id)",
          "title": "VARCHAR(255) NOT NULL",
          "category": "VARCHAR(100) NOT NULL",
          "subcategory": "VARCHAR(100)",
          "article_type": "ENUM('How-To', 'Troubleshooting', 'FAQ', 'Known Error', 'Best Practice', 'Documentation') NOT NULL",
          "status": "ENUM('Borrador', 'En Revisión', 'Publicado', 'Archivado') DEFAULT 'Borrador'",
          "symptoms": "TEXT",
          "solution": "TEXT NOT NULL",
          "keywords": "TEXT",
          "tags": "VARCHAR(500)",
          "author_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "reviewer_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "published_date": "TIMESTAMP",
          "last_reviewed_date": "TIMESTAMP",
          "next_review_date": "DATE",
          "view_count": "INT DEFAULT 0",
          "helpful_count": "INT DEFAULT 0",
          "not_helpful_count": "INT DEFAULT 0",
          "average_rating": "DECIMAL(3,2)",
          "attachments": "JSON",
          "related_cis": "JSON",
          "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP",
          "updated_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP",
          "created_by_id": "UUID FOREIGN KEY REFERENCES users(id)"
        },
        "indexes": [
          "organization_id", 
          "kb_id", 
          "status", 
          "category",
          "published_date",
          "FULLTEXT(title, symptoms, solution, keywords)"
        ]
      },
      
      "service_catalog": {
        "description": "Catálogo de Servicios",
        "fields": {
          "id": "UUID PRIMARY KEY",
          "organization_id": "UUID FOREIGN KEY REFERENCES organizations(id)",
          "name": "VARCHAR(255) NOT NULL",
          "description": "TEXT",
          "category": "VARCHAR(100)",
          "service_type": "ENUM('Request', 'Incident', 'Change') NOT NULL",
          "icon": "VARCHAR(100)",
          "is_active": "BOOLEAN DEFAULT TRUE",
          "approval_required": "BOOLEAN DEFAULT FALSE",
          "estimated_delivery_hours": "INT",
          "price": "DECIMAL(10,2)",
          "form_fields": "JSON",
          "sla_response_hours": "INT",
          "sla_resolution_hours": "INT",
          "assigned_group": "VARCHAR(100)",
          "workflow_id": "UUID",
          "display_order": "INT DEFAULT 0",
          "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP",
          "updated_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"
        },
        "indexes": ["organization_id", "is_active", "category"]
      },
      
      "sla_definitions": {
        "description": "Definiciones de SLA",
        "fields": {
          "id": "UUID PRIMARY KEY",
          "organization_id": "UUID FOREIGN KEY REFERENCES organizations(id)",
          "name": "VARCHAR(255) NOT NULL",
          "description": "TEXT",
          "sla_type": "ENUM('Incident', 'Service Request', 'Problem', 'Change') NOT NULL",
          "priority": "ENUM('Crítica', 'Alta', 'Media', 'Baja')",
          "category": "VARCHAR(100)",
          "response_hours": "INT NOT NULL",
          "resolution_hours": "INT NOT NULL",
          "business_hours_only": "BOOLEAN DEFAULT TRUE",
          "is_active": "BOOLEAN DEFAULT TRUE",
          "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP",
          "updated_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"
        },
        "indexes": ["organization_id", "sla_type", "priority"]
      },
      
      "business_hours": {
        "description": "Horarios de negocio para cálculo de SLA",
        "fields": {
          "id": "UUID PRIMARY KEY",
          "organization_id": "UUID FOREIGN KEY REFERENCES organizations(id)",
          "name": "VARCHAR(100) NOT NULL",
          "timezone": "VARCHAR(50) NOT NULL",
          "monday_start": "TIME",
          "monday_end": "TIME",
          "tuesday_start": "TIME",
          "tuesday_end": "TIME",
          "wednesday_start": "TIME",
          "wednesday_end": "TIME",
          "thursday_start": "TIME",
          "thursday_end": "TIME",
          "friday_start": "TIME",
          "friday_end": "TIME",
          "saturday_start": "TIME",
          "saturday_end": "TIME",
          "sunday_start": "TIME",
          "sunday_end": "TIME",
          "holidays": "JSON",
          "is_default": "BOOLEAN DEFAULT FALSE",
          "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP"
        },
        "indexes": ["organization_id"]
      },
      
      "attachments": {
        "description": "Archivos adjuntos",
        "fields": {
          "id": "UUID PRIMARY KEY",
          "organization_id": "UUID FOREIGN KEY REFERENCES organizations(id)",
          "related_table": "VARCHAR(50) NOT NULL",
          "related_id": "UUID NOT NULL",
          "filename": "VARCHAR(255) NOT NULL",
          "original_filename": "VARCHAR(255) NOT NULL",
          "file_size": "BIGINT NOT NULL",
          "mime_type": "VARCHAR(100)",
          "storage_path": "VARCHAR(500) NOT NULL",
          "uploaded_by_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP"
        },
        "indexes": ["organization_id", "related_table", "related_id"]
      },
      
      "audit_logs": {
        "description": "Logs de auditoría",
        "fields": {
          "id": "UUID PRIMARY KEY",
          "organization_id": "UUID FOREIGN KEY REFERENCES organizations(id)",
          "user_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "action": "VARCHAR(100) NOT NULL",
          "table_name": "VARCHAR(50) NOT NULL",
          "record_id": "UUID NOT NULL",
          "old_values": "JSON",
          "new_values": "JSON",
          "ip_address": "VARCHAR(45)",
          "user_agent": "VARCHAR(500)",
          "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP"
        },
        "indexes": ["organization_id", "user_id", "table_name", "created_at"]
      },
      
      "notifications": {
        "description": "Sistema de notificaciones",
        "fields": {
          "id": "UUID PRIMARY KEY",
          "organization_id": "UUID FOREIGN KEY REFERENCES organizations(id)",
          "user_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "notification_type": "ENUM('email', 'in_app', 'sms', 'webhook') NOT NULL",
          "related_table": "VARCHAR(50)",
          "related_id": "UUID",
          "title": "VARCHAR(255) NOT NULL",
          "message": "TEXT NOT NULL",
          "is_read": "BOOLEAN DEFAULT FALSE",
          "read_at": "TIMESTAMP",
          "sent_at": "TIMESTAMP",
          "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP"
        },
        "indexes": ["organization_id", "user_id", "is_read", "created_at"]
      },
      
      "dashboards": {
        "description": "Dashboards personalizados",
        "fields": {
          "id": "UUID PRIMARY KEY",
          "organization_id": "UUID FOREIGN KEY REFERENCES organizations(id)",
          "user_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "name": "VARCHAR(255) NOT NULL",
          "is_default": "BOOLEAN DEFAULT FALSE",
          "is_public": "BOOLEAN DEFAULT FALSE",
          "layout": "JSON NOT NULL",
          "widgets": "JSON NOT NULL",
          "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP",
          "updated_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"
        },
        "indexes": ["organization_id", "user_id"]
      },
      
      "reports": {
        "description": "Reportes guardados",
        "fields": {
          "id": "UUID PRIMARY KEY",
          "organization_id": "UUID FOREIGN KEY REFERENCES organizations(id)",
          "created_by_id": "UUID FOREIGN KEY REFERENCES users(id)",
          "name": "VARCHAR(255) NOT NULL",
          "description": "TEXT",
          "report_type": "VARCHAR(100) NOT NULL",
          "is_scheduled": "BOOLEAN DEFAULT FALSE",
          "schedule_frequency": "ENUM('daily', 'weekly', 'monthly')",
          "schedule_config": "JSON",
          "recipients": "JSON",
          "parameters": "JSON",
          "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP",
          "updated_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP"
        },
        "indexes": ["organization_id", "created_by_id"]
      }
    },
    
    "api_endpoints": {
      "description": "Endpoints REST API recomendados",
      "authentication": "JWT Bearer Token",
      "base_url": "https://api.yourdomain.com/v1",
      
      "endpoints": {
        "incidents": {
          "POST /incidents": "Crear nuevo incidente",
          "GET /incidents": "Listar incidentes (con paginación, filtros)",
          "GET /incidents/{id}": "Obtener detalle de incidente",
          "PUT /incidents/{id}": "Actualizar incidente",
          "DELETE /incidents/{id}": "Eliminar incidente",
          "POST /incidents/{id}/notes": "Agregar nota a incidente",
          "POST /incidents/{id}/assign": "Asignar incidente",
          "POST /incidents/{id}/resolve": "Resolver incidente",
          "POST /incidents/{id}/close": "Cerrar incidente",
          "GET /incidents/{id}/history": "Historial de cambios"
        },
        "service_requests": {
          "POST /service-requests": "Crear solicitud",
          "GET /service-requests": "Listar solicitudes",
          "GET /service-requests/{id}": "Detalle de solicitud",
          "PUT /service-requests/{id}": "Actualizar solicitud",
          "POST /service-requests/{id}/approve": "Aprobar solicitud",
          "POST /service-requests/{id}/reject": "Rechazar solicitud"
        },
        "problems": {
          "POST /problems": "Crear problema",
          "GET /problems": "Listar problemas",
          "GET /problems/{id}": "Detalle de problema",
          "PUT /problems/{id}": "Actualizar problema",
          "POST /problems/{id}/incidents": "Vincular incidentes"
        },
        "changes": {
          "POST /changes": "Crear RFC",
          "GET /changes": "Listar cambios",
          "GET /changes/{id}": "Detalle de cambio",
          "PUT /changes/{id}": "Actualizar cambio",
          "POST /changes/{id}/approve": "Aprobar cambio",
          "POST /changes/{id}/implement": "Marcar como implementado"
        },
        "cmdb": {
          "POST /configuration-items": "Crear CI",
          "GET /configuration-items": "Listar CIs",
          "GET /configuration-items/{id}": "Detalle de CI",
          "PUT /configuration-items/{id}": "Actualizar CI",
          "GET /configuration-items/{id}/relationships": "Ver relaciones",
          "POST /configuration-items/{id}/relationships": "Crear relación"
        },
        "knowledge": {
          "POST /knowledge-base": "Crear artículo",
          "GET /knowledge-base": "Listar artículos",
          "GET /knowledge-base/{id}": "Ver artículo",
          "PUT /knowledge-base/{id}": "Actualizar artículo",
          "POST /knowledge-base/{id}/publish": "Publicar artículo",
          "POST /knowledge-base/{id}/rate": "Calificar artículo"
        },
        "reports": {
          "GET /reports/incidents": "Reporte de incidentes",
          "GET /reports/sla-compliance": "Cumplimiento SLA",
          "GET /reports/performance": "Métricas de rendimiento",
          "GET /reports/trends": "Análisis de tendencias",
          "POST /reports/custom": "Generar reporte personalizado"
        },
        "dashboard": {
          "GET /dashboard/stats": "Estadísticas del dashboard",
          "GET /dashboard/widgets": "Widgets disponibles"
        }
      }
    },
    
    "best_practices": {
      "security": [
        "Implementar autenticación JWT con refresh tokens",
        "Encriptar datos sensibles en reposo (AES-256)",
        "Usar HTTPS/TLS para todas las comunicaciones",
        "Implementar rate limiting por IP y por usuario",
        "Validación de entrada en todos los endpoints",
        "Principio de mínimo privilegio para roles",
        "Logs de auditoría para todas las acciones críticas",
        "Implementar 2FA para usuarios administradores"
      ],
      "performance": [
        "Índices en campos más consultados",
        "Paginación en listados (máximo 100 registros)",
        "Cache con Redis para consultas frecuentes",
        "Lazy loading para relaciones",
        "Compresión GZIP en API responses",
        "CDN para archivos estáticos",
        "Query optimization con EXPLAIN",
        "Archivado de registros antiguos (> 2 años)"
      ],
      "itil_compliance": [
        "Flujos de trabajo basados en ITIL v4",
        "Cálculo automático de prioridad (matriz impacto x urgencia)",
        "Tracking de SLA con alertas tempranas",
        "Relaciones entre incidentes, problemas y cambios",
        "CMDB actualizada y validada regularmente",
        "Base de conocimiento vinculada a resoluciones",
        "Métricas ITIL: MTTR, MTBF, FCR, backlog",
        "Proceso de mejora continua (CSI)"
      ],
      "multi_tenancy": [
        "Aislamiento de datos por organization_id",
        "Subdominios personalizados por cliente",
        "Customización de campos por organización",
        "Planes con límites configurables",
        "Facturación automatizada",
        "Backups independientes por tenant"
      ],
      "scalability": [
        "Diseño horizontal para escalar",
        "Microservicios para módulos independientes",
        "Message queues para procesamiento asíncrono",
        "Separación read/write con replicas",
        "Sharding por organization_id si es necesario",
        "Monitoreo con Prometheus/Grafana"
      ]
    },
    
    "kpis_metrics": {
      "incident_management": {
        "MTTR": "Mean Time To Resolve - Tiempo promedio de resolución",
        "MTTA": "Mean Time To Acknowledge - Tiempo promedio de primera respuesta",
        "FCR": "First Call Resolution - % resuelto en primer contacto",
        "Backlog": "Número de incidentes abiertos",
        "SLA_Compliance": "% de cumplimiento de SLA",
        "Incidents_by_Priority": "Distribución por prioridad",
        "Incidents_by_Category": "Distribución por categoría",
        "Reopened_Rate": "% de incidentes reabiertos"
      },
      "problem_management": {
        "Problems_Identified": "Problemas identificados en período",
        "Known_Errors": "Errores conocidos documentados",
        "Problems_Resolved": "Problemas resueltos",
        "Recurring_Incidents": "Incidentes recurrentes reducidos"
      },
      "change_management": {
        "Changes_Success_Rate": "% de cambios exitosos",
        "Emergency_Changes": "% de cambios de emergencia",
        "Changes_by_Risk": "Distribución por nivel de riesgo",
        "Failed_Changes": "Cambios fallidos con análisis"
      },
      "service_desk": {
        "CSAT": "Customer Satisfaction Score",
        "Tickets_Per_Agent": "Tickets por agente",
        "Average_Handle_Time": "Tiempo promedio de atención",
        "Self_Service_Usage": "% uso de autoservicio/KB"
      }
    }
  }
}
